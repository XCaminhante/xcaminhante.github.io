<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>CacheUnderTheHood/EntryInfoFromEval - Vesta Wiki</title>
<script type="text/javascript" src="moin_static199/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static199/vesta/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../moin_static199/vesta/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../moin_static199/vesta/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../moin_static199/vesta/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static199/vesta/css/msie.css">
<![endif]-->


<link rel="alternate" title="Vesta Wiki: CacheUnderTheHood/EntryInfoFromEval" href="EntryInfoFromEval%3Fdiffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=CacheUnderTheHood%252FEntryInfoFromEval&amp;ddiffs=1.html" type="application/rss+xml">


<link rel="Start" href="FrontPage.html">
<link rel="Alternate" title="Wiki Markup" href="EntryInfoFromEval%3Faction=raw.html">
<link rel="Alternate" media="print" title="Print View" href="EntryInfoFromEval%3Faction=print.html">
<link rel="Up" href="../CacheUnderTheHood.html">
<link rel="Search" href="FindPage.html">
<link rel="Index" href="TitleIndex.html">
<link rel="Glossary" href="WordIndex.html">
<link rel="Help" href="HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr">

<div id="header">

<form id="searchform" method="get" action="EntryInfoFromEval.html">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="FrontPage.html"><img src="wiki/vesta/img/1line.png" alt="Vesta" height=44 width=202></a></div>
<div id="locationline">

<ul id="pagelocation">
<li><a href="../CacheUnderTheHood.html">CacheUnderTheHood</a></li><li><a href="EntryInfoFromEval.html">EntryInfoFromEval</a></li>
</ul>

</div>
</div>

<div id="sidebar">
<div class="sidepanel">
<h1>Wiki</h1>

<ul id="navibar">
<li class="wikilink"><a href="RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a href="FindPage.html">FindPage</a></li><li class="wikilink"><a href="HelpContents.html">HelpContents</a></li><li class="current"><a href="EntryInfoFromEval.html">EntryInfoFromEval</a></li>
</ul>

</div>
<div class="sidepanel">
<h1>User</h1>
<ul id="username"><li><a href="EntryInfoFromEval%3Faction=login.html" id="login" rel="nofollow">Login</a></li></ul>
</div>
</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="EntryInfoFromEval.html#Background">Background</a></li><li>
<a href="EntryInfoFromEval.html#Evaluator.27s_-trace_Output">Evaluator's -trace Output</a></li><li>
<a href="EntryInfoFromEval.html#Evaluator.27s_-cdebug_All_Output">Evaluator's -cdebug All Output</a></li></ol></div> <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867">
<h1 id="Background">Background</h1>
<span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line862">Each entry in the Vesta cache is uniquely identified by its <a href="../CacheIndex.html">CacheIndex</a>.  To find where an entry is stored on disk you also need its <a href="../PrimaryKey.html">PrimaryKey</a>.  You can get the evaluator to tell you these. <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line862">If you only know the <a href="../CacheIndex.html">CacheIndex</a> you can find the <a href="../PrimaryKey.html">PrimaryKey</a> using the <a href="../GraphLog.html">GraphLog</a>.  See <a href="PrimaryKeyFromCacheIndex.html">CacheUnderTheHood/PrimaryKeyFromCacheIndex</a>. <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><p class="line862">An important related topic is <a href="../HowCachingWorks.html">HowCachingWorks</a>. <span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><p class="line867">
<h1 id="Evaluator.27s_-trace_Output">Evaluator's -trace Output</h1>
<span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><p class="line862">The evaluator's -trace command-line flag will print a representation of the call graph after the evaluation completes.  This includes the <a href="../CacheIndex.html">CacheIndex</a> of every cache hit that the evaluator got and every new entry that the evaluator added to the cache. <span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><p class="line874">A cache hit will be represented by a line in the trace like this: <span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><p class="line867"><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><pre><span class="anchor" id="line-1"></span>  12. /vesta/example.com.org/foo/bar/34/build.ves: function(): hit (ci=5678)</pre><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line874">Where: <span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><ul><li>&quot;12&quot; is the function call depth <span class="anchor" id="line-28"></span></li><li><p class="line891"><tt>/vesta/example.com.org/foo/bar/34/build.ves</tt> is the SDL model file where the function being called was defined <span class="anchor" id="line-29"></span></li><li>&quot;function&quot; is the name of the function being called <span class="anchor" id="line-30"></span></li><li><p class="line862">&quot;5678&quot; is the <a href="../CacheIndex.html">CacheIndex</a> of the entry found for the cache hit <span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span></li></ul><p class="line874">A cache miss will be represented by a line in the trace like this: <span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><p class="line867"><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><pre><span class="anchor" id="line-1-1"></span>  12. /vesta/example.com.org/foo/bar/34/build.ves: function():  miss</pre><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><p class="line874">Followed later by a lit where a cache entry is added: <span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><p class="line867"><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><pre><span class="anchor" id="line-1-2"></span>  12. /vesta/example.com.org/foo/bar/34/build.ves: function(): add (ci=5678)</pre><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><p class="line867">
<h1 id="Evaluator.27s_-cdebug_All_Output">Evaluator's -cdebug All Output</h1>
<span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><p class="line874">If you add &quot;-cdebug All&quot; to the evaluator's command line, it will print verbose information about its interaction with the cache server (every remote procedure call to the cache server, and every response from the cache server).  This is a little more helpful when investigating the contents of the cache, but can be a lot of output. <span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><p class="line874">A cache hit will come from a lookup call that succeeds.  A Lookup call looks like this: <span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><p class="line867"><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><pre><span class="anchor" id="line-1-3"></span>08:16:29.350 08/07/2007 -- CALLING -- Lookup (call #15)
<span class="anchor" id="line-2"></span>  pk = 835d2ea50651acdc bb75117e4596bc71
<span class="anchor" id="line-3"></span>  epoch = 0
<span class="anchor" id="line-4"></span>  fps =
<span class="anchor" id="line-5"></span>    ...</pre><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><p class="line862">Here <tt>835d2ea50651acdc&nbsp;bb75117e4596bc71</tt> is the <a href="../PrimaryKey.html">PrimaryKey</a>. <span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><p class="line874">The result of a lookup that's a cache hit looks like this: <span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><p class="line867"><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><pre><span class="anchor" id="line-1-4"></span>08:16:29.350 08/07/2007 -- RETURNED -- Lookup (call #15)
<span class="anchor" id="line-2-1"></span>  result = Hit
<span class="anchor" id="line-3-1"></span>  index = 276988
<span class="anchor" id="line-4-1"></span>  value =
<span class="anchor" id="line-5-1"></span>    ...</pre><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line862">Here 276988 is the <a href="../CacheIndex.html">CacheIndex</a>. <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line874">A cache miss may be a lookup call that fails: <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line867"><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><pre><span class="anchor" id="line-1-5"></span>08:16:29.350 08/07/2007 -- RETURNED -- Lookup (call #15)
<span class="anchor" id="line-2-2"></span>  result = Miss</pre><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><p class="line862">However, each cache lookup call is preceded by a FreeVariables call. <span class="anchor" id="line-80"></span>The evaluator proceeds to the lookup call only if the result of the FreeVariables call is non-empty, as in this case: <span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><p class="line867"><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><pre><span class="anchor" id="line-1-6"></span>08:16:29.353 08/07/2007 -- CALLING -- FreeVariables (call #16)
<span class="anchor" id="line-2-3"></span>  pk = 478ca864f5565fb9 e2cad9b4c396b415
<span class="anchor" id="line-3-2"></span>
<span class="anchor" id="line-4-2"></span>08:16:29.353 08/07/2007 -- RETURNED -- FreeVariables (call #16)
<span class="anchor" id="line-5-2"></span>  epoch = 1
<span class="anchor" id="line-6"></span>  isEmpty = false
<span class="anchor" id="line-7"></span>  names =
<span class="anchor" id="line-8"></span>    ...</pre><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><p class="line862">If the result of the FreeVariables call is empty (meaning that there there are no cache entries for that <a href="../PrimaryKey.html">PrimaryKey</a>), no Lookup call is made.  A FreeVariables call with an empty result says &quot;isEmpty = true&quot;: <span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><p class="line867"><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><pre><span class="anchor" id="line-1-7"></span>17:50:35.568 08/08/2007 -- CALLING -- FreeVariables (call #75)
<span class="anchor" id="line-2-4"></span>  pk = e668b1f3fe28ed85 0c32d30be573cf1b
<span class="anchor" id="line-3-3"></span>
<span class="anchor" id="line-4-3"></span>17:50:35.569 08/08/2007 -- RETURNED -- FreeVariables (call #75)
<span class="anchor" id="line-5-3"></span>  epoch = 0
<span class="anchor" id="line-6-1"></span>  isEmpty = true
<span class="anchor" id="line-7-1"></span>  names =
<span class="anchor" id="line-8-1"></span>  names.tbl = &lt;empty&gt;</pre><span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><p class="line874">After a cache miss the evaluator will add cache entry once in completes the work of the function call.  Here's an example of a call to add an entry: <span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><p class="line867"><span class="anchor" id="line-109"></span><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><pre><span class="anchor" id="line-1-8"></span>09:07:14.754 08/09/2007 -- CALLING -- AddEntry (call #71)
<span class="anchor" id="line-2-5"></span>  pk = 6e47065e33ef5c47 979276a1ed5ec41e
<span class="anchor" id="line-3-4"></span>  names =
<span class="anchor" id="line-4-4"></span>    nm[0] = ...
<span class="anchor" id="line-5-4"></span>    ...
<span class="anchor" id="line-6-2"></span>  fps =
<span class="anchor" id="line-7-2"></span>    fp[0] = ...
<span class="anchor" id="line-8-2"></span>    ...
<span class="anchor" id="line-9"></span>  value =
<span class="anchor" id="line-10"></span>    ...
<span class="anchor" id="line-11"></span>  model = 2381851557
<span class="anchor" id="line-12"></span>  kids = { 15603 }
<span class="anchor" id="line-13"></span>  sourceFunc = /vesta/example.com.org/foo/bar/34/build.ves/func(), line 33, col 8
<span class="anchor" id="line-14"></span>
<span class="anchor" id="line-15"></span>09:07:14.754 08/09/2007 -- RETURNED -- AddEntry (call #71)
<span class="anchor" id="line-16"></span>  result = Entry Added
<span class="anchor" id="line-17"></span>  ci = 23622</pre><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><p class="line862">The <a href="../CacheIndex.html">CacheIndex</a> of the new entry is 23622.  Its <a href="../PrimaryKey.html">PrimaryKey</a> is <tt>6e47065e33ef5c47&nbsp;979276a1ed5ec41e</tt>. <span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><p class="line862">It called another function with <a href="../CacheIndex.html">CacheIndex</a> 15603.  &quot;sourceFunc&quot; is a text string that gets stored in the cache to help users identify what a <a href="../PrimaryKey.html">PrimaryKey</a> corresponds to. <span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><p class="line862">If you don't need the full debug output but you are looking for the <a href="../PrimaryKey.html">PrimaryKey</a> and <a href="../CacheIndex.html">CacheIndex</a> of some entries, you may want to pass the &quot;-cdebug All&quot; output through grep: <span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><p class="line867"><span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><pre><span class="anchor" id="line-1-9"></span>% vmake -cdebug All | grep -E 'CALLING|RETURNED|pk = |result = |ci = |index = |isEmpty = '
<span class="anchor" id="line-2-6"></span>...
<span class="anchor" id="line-3-5"></span>09:07:13.602 08/09/2007 -- CALLING -- FreeVariables (call #2)
<span class="anchor" id="line-4-5"></span>  pk = 886d4337d383f799 74f0ebbe997b2378
<span class="anchor" id="line-5-5"></span>09:07:13.602 08/09/2007 -- RETURNED -- FreeVariables (call #2)
<span class="anchor" id="line-6-3"></span>  isEmpty = true
<span class="anchor" id="line-7-3"></span>09:07:13.602 08/09/2007 -- CALLING -- FreeVariables (call #3)
<span class="anchor" id="line-8-3"></span>  pk = ab6ec2cfbf411716 a5ef62bd5cfba296
<span class="anchor" id="line-9-1"></span>09:07:13.602 08/09/2007 -- RETURNED -- FreeVariables (call #3)
<span class="anchor" id="line-10-1"></span>  isEmpty = false
<span class="anchor" id="line-11-1"></span>09:07:13.603 08/09/2007 -- CALLING -- Lookup (call #4)
<span class="anchor" id="line-12-1"></span>  pk = ab6ec2cfbf411716 a5ef62bd5cfba296
<span class="anchor" id="line-13-1"></span>09:07:13.603 08/09/2007 -- RETURNED -- Lookup (call #4)
<span class="anchor" id="line-14-1"></span>  result = Hit
<span class="anchor" id="line-15-1"></span>  index = 15508
<span class="anchor" id="line-16-1"></span>...
<span class="anchor" id="line-17-1"></span>09:07:14.782 08/09/2007 -- CALLING -- AddEntry (call #88)
<span class="anchor" id="line-18"></span>  pk = fdc24478070e23e3 424e7098d6999a4d
<span class="anchor" id="line-19"></span>09:07:14.788 08/09/2007 -- RETURNED -- AddEntry (call #88)
<span class="anchor" id="line-20"></span>  result = Entry Added
<span class="anchor" id="line-21"></span>  ci = 23624
<span class="anchor" id="line-22"></span>...</pre><span class="anchor" id="line-158"></span><span class="anchor" id="bottom"></span></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>
</html>

