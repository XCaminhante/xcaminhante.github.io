<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>RemoteCheckoutSetup - Vesta Wiki</title>
<script type="text/javascript" src="moin_static199/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="moin_static199/vesta/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="moin_static199/vesta/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="moin_static199/vesta/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="moin_static199/vesta/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="moin_static199/vesta/css/msie.css">
<![endif]-->


<link rel="alternate" title="Vesta Wiki: RemoteCheckoutSetup" href="RemoteCheckoutSetup%3Fdiffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=RemoteCheckoutSetup&amp;ddiffs=1.html" type="application/rss+xml">


<link rel="Start" href="FrontPage.html">
<link rel="Alternate" title="Wiki Markup" href="RemoteCheckoutSetup%3Faction=raw.html">
<link rel="Alternate" media="print" title="Print View" href="RemoteCheckoutSetup%3Faction=print.html">
<link rel="Appendix" title="mastership-transfer.png" href="RemoteCheckoutSetup%3Faction=AttachFile&amp;do=view&amp;target=mastership-transfer.png.html">
<link rel="Appendix" title="replication.png" href="RemoteCheckoutSetup%3Faction=AttachFile&amp;do=view&amp;target=replication.png.html">
<link rel="Search" href="FindPage.html">
<link rel="Index" href="TitleIndex.html">
<link rel="Glossary" href="WordIndex.html">
<link rel="Help" href="HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr">

<div id="header">

<form id="searchform" method="get" action="RemoteCheckoutSetup.html">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="FrontPage.html"><img src="wiki/vesta/img/1line.png" alt="Vesta" height=44 width=202></a></div>
<div id="locationline">

<ul id="pagelocation">
<li><a href="RemoteCheckoutSetup.html">RemoteCheckoutSetup</a></li>
</ul>

</div>
</div>

<div id="sidebar">
<div class="sidepanel">
<h1>Wiki</h1>

<ul id="navibar">
<li class="wikilink"><a href="RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a href="FindPage.html">FindPage</a></li><li class="wikilink"><a href="HelpContents.html">HelpContents</a></li><li class="current"><a href="RemoteCheckoutSetup.html">RemoteCheckoutSetup</a></li>
</ul>

</div>
<div class="sidepanel">
<h1>User</h1>
<ul id="username"><li><a href="RemoteCheckoutSetup%3Faction=login.html" id="login" rel="nofollow">Login</a></li></ul>
</div>
</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="RemoteCheckoutSetup.html#Introduction">Introduction</a><ol><li>
<a href="RemoteCheckoutSetup.html#Background_Information_Crash_Course">Background Information Crash Course</a></li><li>
<a href="RemoteCheckoutSetup.html#Examples">Examples</a></li></ol></li><li>
<a href="RemoteCheckoutSetup.html#Preliminaries">Preliminaries</a><ol><li>
<a href="RemoteCheckoutSetup.html#Hostnames.2C_Addresses.2C_Reachability">Hostnames, Addresses, Reachability</a></li><li>
<a href="RemoteCheckoutSetup.html#Repository_Access">Repository Access</a></li></ol></li><li>
<a href="RemoteCheckoutSetup.html#Repository_Addresses">Repository Addresses</a><ol><li>
<a href="RemoteCheckoutSetup.html#Specifying_Your_Public_Address">Specifying Your Public Address</a></li><li>
<a href="RemoteCheckoutSetup.html#Automatic_Recording">Automatic Recording</a></li><li>
<a href="RemoteCheckoutSetup.html#Use_For_Access_Control">Use For Access Control</a></li></ol></li><li>
<a href="RemoteCheckoutSetup.html#Replication">Replication</a><ol><li>
<a href="RemoteCheckoutSetup.html#Access_Checks">Access Checks</a><ol><li>
<a href="RemoteCheckoutSetup.html#Finding_Objects_to_Replicate">Finding Objects to Replicate</a></li><li>
<a href="RemoteCheckoutSetup.html#Requesting_the_Replication">Requesting the Replication</a></li><li>
<a href="RemoteCheckoutSetup.html#Trusting_the_Source_Repository">Trusting the Source Repository</a></li><li>
<a href="RemoteCheckoutSetup.html#Access_from_Destination_as_Requestor">Access from Destination as Requestor</a></li></ol></li></ol></li><li>
<a href="RemoteCheckoutSetup.html#Mastership">Mastership</a><ol><li>
<a href="RemoteCheckoutSetup.html#Finding_the_Master">Finding the Master</a></li><li>
<a href="RemoteCheckoutSetup.html#Transferring_Mastership">Transferring Mastership</a><ol><li>
<a href="RemoteCheckoutSetup.html#Access_Controls">Access Controls</a></li><li>
<a href="RemoteCheckoutSetup.html#Networking_Details">Networking Details</a></li><li>
<a href="RemoteCheckoutSetup.html#Automatic_Recovery">Automatic Recovery</a></li></ol></li></ol></li><li>
<a href="RemoteCheckoutSetup.html#Remote_Checkout_in_Action">Remote Checkout in Action</a></li><li>
<a href="RemoteCheckoutSetup.html#Summary_.2F_Quick_Reference">Summary / Quick Reference</a></li></ol></div> <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><p class="line867">
<h1 id="Introduction">Introduction</h1>
<span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><p class="line862">Vesta supports distributed operation.  Once set up correctly, <a class="http" href="../vesta/doc/man/html/vcheckout.1.html">vcheckout</a> can be used to transparently check out a package from a remote repository.  While the user works on their change all operations happen locally.  When they're done, <a class="http" href="../vesta/doc/man/html/vcheckin.1.html">vcheckin</a> will replicate their changes back to the remote repository. <span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><p class="line874">This page describes what you'll need to do to set this up. <span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><p class="line862">Remote checkout is built on top of operations between peer repositories: <a class="http" href="../vesta/doc/man/html/vesta-intro.1.html#replication">replication</a> and <a class="http" href="../vesta/doc/man/html/vesta-intro.1.html#master">mastership</a> transfer.  Setting up for remote checkout is really a matter of setting up the access controls to allow these operations between particular repositories.  After that, the <a class="http" href="../vesta/doc/man/html/repos-ui.1.html">repository tools</a> take care of the details. <span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line862">Experienced users may want to skip to <a href="RemoteCheckoutSetup.html#quick_ref">the quick reference at the end</a>. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line867">
<h2 id="Background_Information_Crash_Course">Background Information Crash Course</h2>
<span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line874">It's assumed that you understand how hostnames, hostname resolution, and the basics of how TCP/IP works.  It's assumed that you understand and have some control over the networks between the sites you want to set up.  (Be sure to be aware of any firewalls or special packet handling such as NAT or VPNs.)  Here's a few background resources on these topics: <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><ul><li><p class="line891"><a class="http" href="http://en.wikipedia.org/">Wikipedia</a> has articles on: <span class="anchor" id="line-21"></span><ul><li><p class="line891"><a class="http" href="http://en.wikipedia.org/wiki/IPv4">IPv4</a> (the version of IP which Vesta currently supports) <span class="anchor" id="line-22"></span></li><li><p class="line891"><a class="http" href="http://en.wikipedia.org/wiki/Transmission_Control_Protocol">TCP</a> (the specific IP protocol used during remote checkout) <span class="anchor" id="line-23"></span></li><li><p class="line891"><a class="http" href="http://en.wikipedia.org/wiki/Domain_Name_System">DNS</a> (the protocol used to provide the mapping from hostname to IP addresses across the Internet at large) <span class="anchor" id="line-24"></span></li></ul></li><li><p class="line891"><a class="http" href="http://tldp.org/">The Linux Documentation Project</a> has some instructional guides: <span class="anchor" id="line-25"></span><ul><li><p class="line891"><a class="http" href="http://tldp.org/HOWTO/Networking-Overview-HOWTO.html">The Linux Networking Overview</a> <span class="anchor" id="line-26"></span></li><li><p class="line891"><a class="http" href="http://tldp.org/HOWTO/DNS-HOWTO.html">DNS HOWTO</a>: how to run a DNS server to provide hostname resolution for your domains <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span></li></ul></li></ul><p class="line862">It's assumed that you understand the basics of <em><a class="http" href="http://en.wikipedia.org/wiki/Client_server">client/server networking</a></em>.  It's assumed that you understand that Vesta uses a <a class="http" href="../vesta/doc/man/html/repository.8.html">repository server</a> which can be accessed by multiple clients. <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><p class="line862">It's assumed that you understand what the term &quot;<em>realm</em>&quot; means in a Vesta context and how a realm is used to form <em>global identifiers</em> for users and groups.  If not, <a class="http" href="../vesta/doc/man/html/repository.8.html#Principal%20identification%20and%20authentication">see the repository(8) man page</a>. <span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><p class="line874">It's assumed that you understand how the basic Vesta operations like checkout and checkin work.  Presumably you already have one Vesta server up and running and are familiar with its basic operation. <span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><p class="line874">Here are some basic Vesta informational resources: <span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><ul><li><p class="line891"><a class="http" href="../vesta/doc/man/html/vesta-intro.1.html">The vesta-intro(1) man page</a> defines terminology and gives some basic background information. <span class="anchor" id="line-37"></span></li><li><p class="line862">The <a class="http" href="../vesta/doc/tutorial.html">tutorial</a> and <a class="http" href="../vesta/doc/command-summary.html">command summary</a> will help you get familiar with the Vesta basics. <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span></li></ul><p class="line874">It's assumed that you have secured the network connection between the peer sites.  This document doesn't cover anything about encryption and relies upon simple host-based authentication. <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line867">
<h2 id="Examples">Examples</h2>
<span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><p class="line874">Throughout this page examples will use a fictional company with two geographically distributed sites. <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><p class="line862">The fictional company's domain is &quot;<tt>example.com</tt>&quot;. <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><p class="line862">The two sites are represented by the sub-domains &quot;<tt>foo.example.com</tt>&quot; and &quot;<tt>bar.example.com</tt>&quot;.  These sub-domains are also used as the <em>realms</em> for Vesta  <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><p class="line862">The Vesta servers have the hostnames &quot;<tt>vesta.foo.example.com</tt>&quot; and &quot;<tt>vesta.bar.example.com</tt>&quot;. <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><p class="line862">Client hosts (workstations used by individual contributors) have hostnames &quot;<tt>client.foo.example.com</tt>&quot; and &quot;<tt>client.bar.example.com</tt>&quot;. <span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><p class="line862">When not using a special account such as <tt>vadmin</tt>, we'll use the fictional user &quot;<tt>jsmith</tt>&quot;.  (In the two realms his global identities are of course &quot;<tt>jsmith@foo.example.com</tt>&quot; and &quot;<tt>jsmith@bar.example.com</tt>&quot;. <span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><p class="line867">
<h1 id="Preliminaries">Preliminaries</h1>
<span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><p class="line874">Before we talk about the setup in detail, let's make sure the basic networking infrastructure is working correctly and that each site has simple access to the peer repository. <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><p class="line867">
<h2 id="Hostnames.2C_Addresses.2C_Reachability">Hostnames, Addresses, Reachability</h2>
<span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><p class="line862">Each repository server must have a hostname which can be resolved to an IP address by its peer repositories.  In our example, the servers are &quot;<tt>vesta.foo.example.com</tt>&quot; and &quot;<tt>vesta.bar.example.com</tt>&quot;.  We should start by logging into each of those and making sure that we can get an IP address for the other. <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><p class="line867"><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><pre><span class="anchor" id="line-1"></span>vesta.foo.example.com% host vesta.bar.example.com
<span class="anchor" id="line-2"></span>vesta.bar.example.com has address 10.2.1.1</pre><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><p class="line867"><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><pre><span class="anchor" id="line-1-1"></span>vesta.bar.example.com% host vesta.foo.example.com
<span class="anchor" id="line-2-1"></span>vesta.foo.example.com has address 10.1.1.1</pre><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><ul><li style="list-style-type:none"><p class="line891"><em>If you don't have the host(1) command try nslookup(1) or dig(1).  Alternatively you can skip to the next step and let ping(8) do hostname resolution for you.</em> <span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span></li></ul><p class="line874">We should also make sure that each server can send packets to and receive from the other.  One way we can do this is by using ping(8): <span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><p class="line867"><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><pre><span class="anchor" id="line-1-2"></span>vesta.foo.example.com% ping vesta.bar.example.com
<span class="anchor" id="line-2-2"></span>PING vesta.bar.example.com (10.2.1.1) 56(84) bytes of data.
<span class="anchor" id="line-3"></span>64 bytes from vesta.bar.example.com (10.2.1.1): icmp_seq=1 ttl=64 time=0.232 ms
<span class="anchor" id="line-4"></span>64 bytes from vesta.bar.example.com (10.2.1.1): icmp_seq=2 ttl=64 time=0.225 ms
<span class="anchor" id="line-5"></span>64 bytes from vesta.bar.example.com (10.2.1.1): icmp_seq=3 ttl=64 time=0.225 ms
<span class="anchor" id="line-6"></span>64 bytes from vesta.bar.example.com (10.2.1.1): icmp_seq=4 ttl=64 time=0.232 ms
<span class="anchor" id="line-7"></span>
<span class="anchor" id="line-8"></span>--- vesta.bar.example.com ping statistics ---
<span class="anchor" id="line-9"></span>4 packets transmitted, 4 received, 0% packet loss, time 3002ms
<span class="anchor" id="line-10"></span>rtt min/avg/max/mdev = 0.225/0.228/0.232/0.015 ms</pre><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><p class="line867"><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><pre><span class="anchor" id="line-1-3"></span>vesta.bar.example.com% ping vesta.foo.example.com
<span class="anchor" id="line-2-3"></span>PING vesta.foo.example.com (10.1.1.1) 56(84) bytes of data.
<span class="anchor" id="line-3-1"></span>64 bytes from vesta.foo.example.com (10.1.1.1): icmp_seq=1 ttl=64 time=0.232 ms
<span class="anchor" id="line-4-1"></span>64 bytes from vesta.foo.example.com (10.1.1.1): icmp_seq=2 ttl=64 time=0.225 ms
<span class="anchor" id="line-5-1"></span>64 bytes from vesta.foo.example.com (10.1.1.1): icmp_seq=3 ttl=64 time=0.225 ms
<span class="anchor" id="line-6-1"></span>64 bytes from vesta.foo.example.com (10.1.1.1): icmp_seq=4 ttl=64 time=0.232 ms
<span class="anchor" id="line-7-1"></span>
<span class="anchor" id="line-8-1"></span>--- vesta.foo.example.com ping statistics ---
<span class="anchor" id="line-9-1"></span>4 packets transmitted, 4 received, 0% packet loss, time 3002ms
<span class="anchor" id="line-10-1"></span>rtt min/avg/max/mdev = 0.225/0.228/0.232/0.015 ms</pre><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><ul><li style="list-style-type:none"><p class="line891"><em>Note that ping may not work in all situations.  Some firewalls will block ping but allow TCP connections through.</em> <span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><p class="line891"><em>In some cases, it may be worth repeating the above tests from the client hosts as well (&quot;<tt>client.foo.example.com</tt>&quot; and &quot;<tt>client.bar.example.com</tt>&quot; in our example) to ensure that they can also resolve the hostname of and reach the repository at the other site.</em> <span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span></li></ul><p class="line874">In the examples on this page, we're going to use reverse hostname mappings (aka reverse DNS) to determine access.  We should check that the reverse mappings are in place and give us the right hostnames. <span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><p class="line867"><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><pre><span class="anchor" id="line-1-4"></span>vesta.foo.example.com% host 10.2.1.1
<span class="anchor" id="line-2-4"></span>1.1.2.10.in-addr.arpa domain name pointer vesta.bar.example.com.</pre><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><p class="line867"><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><pre><span class="anchor" id="line-1-5"></span>vesta.bar.example.com% host 10.1.1.1
<span class="anchor" id="line-2-5"></span>1.1.1.10.in-addr.arpa domain name pointer vesta.foo.example.com.</pre><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><ul><li style="list-style-type:none"><p class="line891"><em>You don't have to use reverse mappings for access controls.  Alternatives will be mentioned.</em> <span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span></li></ul><p class="line867">
<h2 id="Repository_Access">Repository Access</h2>
<span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><p class="line862">Now that we've made sure have basic addressing and network connectivity, let's grant access to the peer sites.  Each repository has an <a class="http" href="../vesta/doc/man/html/repository.8.html#Export%20file">export file</a> which controls which client hosts it will accept requests from.  We'll need to add entries to the export file on each of our two repositories to allow the hosts at the other site access. <span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><ul><li style="list-style-type:none"><p class="line891"><em>If you're using the installable RPM/Debian packages, you can find the export file in <tt>/etc/vesta/repos.export</tt>.  If not, type &quot;<tt>vgetconfig&nbsp;Repository&nbsp;export_file</tt>&quot;.  If that's a relative path, it's below the directory printed by &quot;<tt>vgetconfig&nbsp;Repository&nbsp;metadata_root</tt>&quot;.</em> <span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span></li></ul><p class="line862">In the export file on &quot;<tt>vesta.foo.example.com</tt>&quot; we'll add these lines: <span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><p class="line867"><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><pre><span class="anchor" id="line-1-6"></span># Allow any host in the bar.example.com access with the relam bar.example.com
<span class="anchor" id="line-2-6"></span>*.bar.example.com: allow global bar.example.com</pre><span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><p class="line862">Similarly, in the export file on &quot;<tt>vesta.bar.example.com</tt>&quot; we'll add these lines: <span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><p class="line867"><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><pre><span class="anchor" id="line-1-7"></span># Allow any host in the foo.example.com access with the relam foo.example.com
<span class="anchor" id="line-2-7"></span>*.foo.example.com: allow global foo.example.com</pre><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><ul><li style="list-style-type:none"><p class="line891"><em>After modifying the export file, you can use the <a class="http" href="../vesta/doc/man/html/vaccessrefresh.8.html">vaccessrefresh</a> utility to get the running server to reload it.  Alternatively, you can stop and restart the repository server process.</em> <span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><p class="line891"><em>Instead of using reverse DNS, we could use a <a class="http" href="http://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing">CIDR</a> IP range.  If all hosts in &quot;<tt>foo.example.com</tt>&quot; have IPs starting with 10.1 and all hosts in &quot;<tt>bar.example.com</tt>&quot; have IPs starting with 10.2 then we could have used &quot;<tt>10.1.0.0/16</tt>&quot; and &quot;<tt>10.2.0.0/16</tt>&quot; instead.</em> <span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span></li></ul><p class="line862">Now that we've granted some access, let's check that the remote repository is allowing us in.  We can do this with the <a class="http" href="../vesta/doc/man/html/vid.1.html">vid</a> utility. <span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><p class="line867"><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><pre><span class="anchor" id="line-1-8"></span>vesta.foo.example.com% vid -R vesta.bar.example.com
<span class="anchor" id="line-2-8"></span>User names and aliases:
<span class="anchor" id="line-3-2"></span>  jsmith@foo.example.com
<span class="anchor" id="line-4-2"></span>Groups:
<span class="anchor" id="line-5-2"></span>Unix (NFS) user ID:          1002
<span class="anchor" id="line-6-2"></span>Unix (NFS) primary group ID: 1002</pre><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><p class="line867"><span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><pre><span class="anchor" id="line-1-9"></span>vesta.bar.example.com% vid -R vesta.foo.example.com
<span class="anchor" id="line-2-9"></span>User names and aliases:
<span class="anchor" id="line-3-3"></span>  jsmith@bar.example.com
<span class="anchor" id="line-4-3"></span>Groups:
<span class="anchor" id="line-5-3"></span>Unix (NFS) user ID:          1002
<span class="anchor" id="line-6-3"></span>Unix (NFS) primary group ID: 1002</pre><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><p class="line867">
<h1 id="Repository_Addresses">Repository Addresses</h1>
<span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span><p class="line862">Each repository has a <em>public address</em> which peer sites use to contact it.  This is a hostname and a port and is written as a string: &quot;<em>host</em>:<em>port</em>&quot;.  Assuming we're using the default ports, our two example repositories addresses are: <span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><p class="line867"><span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><pre><span class="anchor" id="line-1-10"></span>vesta.foo.example.com:21776</pre><span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><p class="line867"><span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><pre><span class="anchor" id="line-1-11"></span>vesta.bar.example.com:21776</pre><span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><p class="line867">
<h2 id="Specifying_Your_Public_Address">Specifying Your Public Address</h2>
<span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span><p class="line874">Ideally all repository clients will use the public address to access the repository.  If this is the case, the repository's public address will simply be taken from the config file settings giving the repository's host and port. <span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><p class="line862">However, this may not be feasible in all cases.  For example, a laptop installtion will want to use &quot;<tt>localhost</tt>&quot; to access the repository yet may still have a public address which is valid on a certain network.  In cases like this, you can set the configuration variable <tt>[Repository]master_hint</tt> to explicitly specify the public address of your repository. <span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><p class="line867">
<h2 id="Automatic_Recording">Automatic Recording</h2>
<span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><p class="line862">When you create a new master appendable locally (e.g. a new top-level directory created by <tt>vwizard</tt>), the repository automatically stores the public address of your repository in a &quot;<tt>master-repository</tt>&quot; attribute on that object.  This attribute can be propagated (along with the object) to a replica. <span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><p class="line862">Whenever you transfer mastership of an object between repositories, &quot;<tt>master-repository</tt>&quot; attributes get added/updated. <span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><p class="line862">This is why it's important to get your repository's public address set correctly (e.g. with the <tt>[Repository]master_hint</tt> configuration setting).  If the wrong address gets recorded, or if you don't have any &quot;<tt>master-repository</tt>&quot; attributes, you may need to set them explicitly. <span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><ul><li style="list-style-type:none"><p class="line891"><em>The repository won't set any <tt>master-repository</tt> attributes if you haven't set <tt>[Repository]master_hint</tt> and your repository's address is &quot;<tt>localhost</tt>&quot;.  Obviously &quot;<tt>localhost</tt>:21776&quot; won't be usable for peer repositories to contact your repository.</em> <span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span></li></ul><p class="line862">Suppose for example that the top-level directory <tt>/vesta/foo.example.com</tt> was created in the repository at <tt>vesta.foo.example.com</tt>.  Maybe the initial setup didn't use a fully-qualified hostname (and <tt>[Repository]master_hint</tt> wasn't set either).  The <tt>master-repository</tt> attribute would have recorded this incomplete address: <span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><p class="line867"><span class="anchor" id="line-196"></span><span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span><pre><span class="anchor" id="line-1-12"></span>vesta.foo.example.com% vattrib -g master-repository /vesta/foo.example.com
<span class="anchor" id="line-2-10"></span>vesta:21776</pre><span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><p class="line862">We can simply correct this with <a class="http" href="../vesta/doc/man/html/vattrib.1.html">vattrib</a>: <span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><p class="line867"><span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><span class="anchor" id="line-206"></span><pre><span class="anchor" id="line-1-13"></span>vesta.foo.example.com% vattrib -s master-repository vesta.foo.example.com:21776 /vesta/foo.example.com
<span class="anchor" id="line-2-11"></span>vesta.foo.example.com% vattrib -g master-repository /vesta/foo.example.com
<span class="anchor" id="line-3-4"></span>vesta.foo.example.com:21776</pre><span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><p class="line862">If <tt>/vesta/foo.example.com</tt> has already been replicated to the peer repository at <tt>vesta.bar.example.com</tt>, the attribute will be wrong there as well: <span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span><p class="line867"><span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><pre><span class="anchor" id="line-1-14"></span>vesta.bar.example.com% vattrib -g master-repository /vesta/foo.example.com
<span class="anchor" id="line-2-12"></span>vesta:21776</pre><span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><p class="line862">You can either correct it with <a class="http" href="../vesta/doc/man/html/vattrib.1.html">vattrib</a> the same way as above, or you can use <a class="http" href="../vesta/doc/man/html/vrepl.1.html">vrepl</a> to propagate the attribute change from the other repository: <span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><p class="line867"><span class="anchor" id="line-218"></span><span class="anchor" id="line-219"></span><span class="anchor" id="line-220"></span><span class="anchor" id="line-221"></span><pre><span class="anchor" id="line-1-15"></span>vesta.bar.example.com% vrepl -v -s vesta.foo.example.com -e+ /vesta/foo.example.com -e- &quot;/vesta/foo.example.com/*&quot;
<span class="anchor" id="line-2-13"></span>exists  /vesta/foo.example.com
<span class="anchor" id="line-3-5"></span>attribs /vesta/foo.example.com</pre><span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span><ul><li style="list-style-type:none"><p class="line891"><em>Of course this assumes that you've already set up everything correctly for replication, which we'll talk about in the next section.</em> <span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span></li></ul><p class="line867">
<h2 id="Use_For_Access_Control">Use For Access Control</h2>
<span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span><p class="line862">There are three special <em>access control attributes</em> which are used during distributed operations: <span class="anchor" id="line-228"></span><span class="anchor" id="line-229"></span><ul><li><p class="line891"><tt>#replicate-from</tt> lists the repositories to be trusted as replication sources <span class="anchor" id="line-230"></span></li><li><p class="line891"><tt>#mastership-to</tt> lists the repositories to which we're willing transfer masterhip <span class="anchor" id="line-231"></span></li><li><p class="line891"><tt>#mastership-from</tt> lists the repositories to from which we're willing accept a transfer of masterhip <span class="anchor" id="line-232"></span><span class="anchor" id="line-233"></span></li></ul><p class="line874">The values of each of these attributes are repository addresses.  Each will be described in more detail below. <span class="anchor" id="line-234"></span><span class="anchor" id="line-235"></span><p class="line867">
<h1 id="Replication">Replication</h1>
<span class="anchor" id="line-236"></span><span class="anchor" id="line-237"></span><p class="line867"><em>Replication</em> is the process by which objects under <tt>/vesta</tt> are propagated from one repository to another. <span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><p class="line867"><a class="http" href="../vesta/doc/man/html/vrepl.1.html#Vesta_Replication">There's a short overview of replication on the vrepl(1) man page</a>.  If you want to understand it in depth, see <a class="http" href="http://gatekeeper.research.compaq.com/pub/DEC/SRC/research-reports/abstracts/src-rr-172.html">&quot;Partial Replication in the Vesta Software Repository&quot;</a> (which also explains mastership, which we'll talk about a little later). <span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span><p class="line867">
<h2 id="Access_Checks">Access Checks</h2>
<span class="anchor" id="line-242"></span><span class="anchor" id="line-243"></span><p class="line874">Several access control checks are performed in the course of a replication: <span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><ul><li>The client host accesses both repositories to find the objects to be replicated.  For this, the client host and the user running the tool must have read access to both repositories. <span class="anchor" id="line-246"></span></li><li>The client calls the destination repository asking it to perform a replication from the source repository.  To perform a replication, as user must have read/write access to the destination repository. <span class="anchor" id="line-247"></span></li><li><p class="line862">The destination repository checks that the source repository is trusted as a replication source.  This is done by checking that the source repository is listed in a <tt>#replicate-from</tt> attribute at the destination. <span class="anchor" id="line-248"></span></li><li><p class="line862">The destination repository reads the contents of the replicated objects from the source repository <em>as the requesting user</em>.  For this, the destination repository must be granted access to the source repository <em>with the realm of the requesting user</em>. <span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span></li></ul><p class="line862">To support remote checkout/checkin, we'll need to allow <em>bi-directional replication</em> in both <em>push and pull modes</em>.  The local repository (where the checkout is performed) will need to replicate objects from the remote repository.  When checking in, the local repository must replicate the new version back. <span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><p class="line874">We'll go through each of the access checks listed above and make sure that we've set up the access that we need. <span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span><p class="line867">
<h3 id="Finding_Objects_to_Replicate">Finding Objects to Replicate</h3>
<span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><p class="line862">The first step in performing a replication is checking both the source and destination repositories to find objects which need to be replicated.  Sometimes a replication may specify a complex pattern to be matched (e.g. using <a class="http" href="../vesta/doc/man/html/vrepl.1.html#Directives">the replicator's directive syntax</a>).  Also, the object(s) might already be present at the destination. <span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span><p class="line862">To do this we need read access to both repositories from any client host that might perform a replication.  In our example, the remote site is <tt>bar.example.com</tt>.  We need to make sure that users at that site can access the objects we're interested in replicating in both repositories.  Earlier we checked that the repository server would allow them to make requests with <a class="http" href="../vesta/doc/man/html/vid.1.html">vid</a>, but that doesn't guarantee that they will have sufficient permission to access packages and versions at the repository on <tt>vesta.foo.example.com</tt>. <span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span><p class="line862">We'll assume that there's a package named <tt>/vesta/foo.example.com/a</tt> which contains a version <tt>1</tt>.  Let's eaxmine its attributes from the remote site: <span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span><p class="line867"><span class="anchor" id="line-263"></span><span class="anchor" id="line-264"></span><span class="anchor" id="line-265"></span><pre><span class="anchor" id="line-1-16"></span>client.bar.example.com% vattrib -R vesta.foo.example.com /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-14"></span>vattrib: /vesta/foo.example.com/a/1: No permission</pre><span class="anchor" id="line-266"></span><span class="anchor" id="line-267"></span><p class="line874">We'll need to solve this before we can replicate.  There are several possible ways we could solve this: <span class="anchor" id="line-268"></span><span class="anchor" id="line-269"></span><ul><li><p class="line862">Turn on world read and execute permissions for the enclosing directories (i.e. &quot;<tt>chmod&nbsp;o+rx&nbsp;&nbsp;/vesta/foo.example.com/a&nbsp;/vesta/foo.example.com&nbsp;/vesta</tt>&quot; over at <tt>foo.example.com</tt>) <span class="anchor" id="line-270"></span></li><li><p class="line862">Add the requesting user (<tt>jsmith@bar.example.com</tt>) to a group which has read permission for this package in the <a class="http" href="../vesta/doc/man/html/repository.8.html#Group%20file">repository group file</a> on <tt>vesta.foo.example.com</tt> <span class="anchor" id="line-271"></span><ul><li><p class="line862">For example, you could use this line: <tt>jsmith@bar.example.com:&nbsp;^staff@foo.example.com</tt> <span class="anchor" id="line-272"></span></li><li><p class="line862">Note that, as with changing the export file, you'll need to use <a class="http" href="../vesta/doc/man/html/vaccessrefresh.8.html">vaccessrefresh</a> or restart the repository. <span class="anchor" id="line-273"></span></li></ul></li><li><p class="line862">Give the requesting user permission to act as a local user which has read permission for this package in the <a class="http" href="../vesta/doc/man/html/repository.8.html#Aliases%20and%20the%20alias%20file">repository alias file</a> on <tt>vesta.foo.example.com</tt> <span class="anchor" id="line-274"></span><ul><li><p class="line862">For example, you could use this line: <tt>jsmith@bar.example.com:&nbsp;jsmith@foo.example.com</tt> <span class="anchor" id="line-275"></span></li><li>Again, you'll have to force the repository to reload its access control information <span class="anchor" id="line-276"></span><span class="anchor" id="line-277"></span></li></ul></li></ul><p class="line874">After doing at least one of these, our user should have permission to access the package and its version, so let's try our test again: <span class="anchor" id="line-278"></span><span class="anchor" id="line-279"></span><p class="line867"><span class="anchor" id="line-280"></span><span class="anchor" id="line-281"></span><span class="anchor" id="line-282"></span><span class="anchor" id="line-283"></span><span class="anchor" id="line-284"></span><span class="anchor" id="line-285"></span><span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span><span class="anchor" id="line-290"></span><span class="anchor" id="line-291"></span><span class="anchor" id="line-292"></span><pre><span class="anchor" id="line-1-17"></span>client.bar.example.com% vattrib -R vesta.foo.example.com /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-15"></span>master immutableDirectory
<span class="anchor" id="line-3-6"></span>message
<span class="anchor" id="line-4-4"></span>        initial version of package a
<span class="anchor" id="line-5-4"></span>content
<span class="anchor" id="line-6-4"></span>        /vesta/foo.example.com/a/checkout/1/5
<span class="anchor" id="line-7-2"></span>checkin-time
<span class="anchor" id="line-8-2"></span>        Mon Oct 29 14:33:10 EST 2005
<span class="anchor" id="line-9-2"></span>checkin-by
<span class="anchor" id="line-10-2"></span>        jsmith@foo.example.com
<span class="anchor" id="line-11"></span>#owner
<span class="anchor" id="line-12"></span>        jsmith@foo.example.com</pre><span class="anchor" id="line-293"></span><span class="anchor" id="line-294"></span><p class="line862">We should also repeat this test in the opposite direction, having a user at <tt>foo.example.com</tt> try to access objects in the repository at <tt>vesta.bar.example.com</tt> (similarly modifying access control information to grant access).  In our example we haven't yet replicated anything to <tt>vesta.bar.example.com</tt> for us to access yet.  However, it would be a good idea to revisit this later. <span class="anchor" id="line-295"></span><span class="anchor" id="line-296"></span><p class="line867">
<h3 id="Requesting_the_Replication">Requesting the Replication</h3>
<span class="anchor" id="line-297"></span><span class="anchor" id="line-298"></span><p class="line862">Earlier, we granted each site full access to the peer repository.  (That is, in the <a class="http" href="../vesta/doc/man/html/repository.8.html#Group%20file">repository export file</a> we used &quot;<tt>allow&nbsp;global</tt>&quot; rather than &quot;<tt>readonly&nbsp;global</tt>&quot;.)  This should allow us to perform replications in either direction. <span class="anchor" id="line-299"></span><span class="anchor" id="line-300"></span><p class="line867">
<h3 id="Trusting_the_Source_Repository">Trusting the Source Repository</h3>
<span class="anchor" id="line-301"></span><span class="anchor" id="line-302"></span><p class="line874">Each repository can control which other repositories it trusts as replication souces.  Vesta relies on the full path to an immutable version always referring to identical contents in all repositories.  However, this is not strictly enforced, so you should only choose to allow replication from repositories which you are reasonably certain you can trust. <span class="anchor" id="line-303"></span><span class="anchor" id="line-304"></span><p class="line862">The <tt>#replicate-from</tt> attribute lists the addresses of repositories to be trusted as replication sources.  This can be placed on <tt>/vesta</tt> or subdirectories of it.  In order to determine whther a particular replication is allowed, the repository searches upward from the path to be replicated for the closest enclosing directory with a <tt>#replicate-from</tt> attribute.  The source repository's address <strong>must</strong> be listed in that attribute or permission for the replication will be denied. <span class="anchor" id="line-305"></span><span class="anchor" id="line-306"></span><p class="line862">In our example, we first need to allow replication from the master repository (<tt>vesta.foo.example.com</tt>) to the remote site (<tt>vesta.bar.example.com</tt>).  So we'll add a <tt>#replicate-from</tt> attribute which allows this: <span class="anchor" id="line-307"></span><span class="anchor" id="line-308"></span><p class="line867"><span class="anchor" id="line-309"></span><span class="anchor" id="line-310"></span><pre><span class="anchor" id="line-1-18"></span>client.bar.example.com% vattrib -a #replicate-from vesta.foo.example.com:21776 /vesta</pre><span class="anchor" id="line-311"></span><span class="anchor" id="line-312"></span><ul><li style="list-style-type:none"><p class="line891"><em>You'll need write permission to /vesta in order to add this attribute, which probably means using the special <tt>vadmin</tt> user or <tt>root</tt>.</em> <span class="anchor" id="line-313"></span><span class="anchor" id="line-314"></span></li></ul><p class="line862">Now we'll try a replication of the version we inspected above (<tt>/vesta/foo.example.com/a/1</tt>): <span class="anchor" id="line-315"></span><span class="anchor" id="line-316"></span><p class="line867"><span class="anchor" id="line-317"></span><span class="anchor" id="line-318"></span><span class="anchor" id="line-319"></span><span class="anchor" id="line-320"></span><span class="anchor" id="line-321"></span><span class="anchor" id="line-322"></span><span class="anchor" id="line-323"></span><span class="anchor" id="line-324"></span><span class="anchor" id="line-325"></span><pre><span class="anchor" id="line-1-19"></span>client.bar.example.com% vrepl -v -s vesta.foo.example.com -e+ /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-16"></span>create  /vesta/foo.example.com
<span class="anchor" id="line-3-7"></span>create  /vesta/foo.example.com/a
<span class="anchor" id="line-4-5"></span>copy    /vesta/foo.example.com/a/1
<span class="anchor" id="line-5-5"></span>attribs /vesta/foo.example.com/a/1
<span class="anchor" id="line-6-5"></span>latest  /vesta/foo.example.com/a/latest
<span class="anchor" id="line-7-3"></span>attribs /vesta/foo.example.com/a
<span class="anchor" id="line-8-3"></span>attribs /vesta/foo.example.com</pre><span class="anchor" id="line-326"></span><span class="anchor" id="line-327"></span><p class="line862">Now we're all set to replicate from the remote master.  Hwoever, we also need to be able to replicate back to the remote master so that we we check in a new version from <tt>bar.example.com</tt> it will appear in the repository at <tt>vesta.foo.example.com</tt>.  If we try to replicate the same version back, we'll run into trouble: <span class="anchor" id="line-328"></span><span class="anchor" id="line-329"></span><p class="line867"><span class="anchor" id="line-330"></span><span class="anchor" id="line-331"></span><span class="anchor" id="line-332"></span><span class="anchor" id="line-333"></span><span class="anchor" id="line-334"></span><pre><span class="anchor" id="line-1-20"></span>client.foo.example.com% vrepl -v -s vesta.bar.example.com -e+ /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-17"></span>exists  /vesta/foo.example.com/a/1
<span class="anchor" id="line-3-8"></span>attribs /vesta/foo.example.com/a/1
<span class="anchor" id="line-4-6"></span>vrepl: No permission, copying attribs for /vesta/foo.example.com/a/1</pre><span class="anchor" id="line-335"></span><span class="anchor" id="line-336"></span><p class="line862">This is because we haven't yet granted permission to replicate in the other direction.  We'll have to add a <tt>#replicate-from</tt> over in the repostiory at <tt>vesta.foo.example.com</tt>. <span class="anchor" id="line-337"></span><span class="anchor" id="line-338"></span><p class="line867"><span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span><pre><span class="anchor" id="line-1-21"></span>vesta.foo.example.com% vattrib -a #replicate-from vesta.bar.example.com:21776 /vesta</pre><span class="anchor" id="line-341"></span><span class="anchor" id="line-342"></span><ul><li style="list-style-type:none"><p class="line891"><em>Again, you'll probably need administrator access to do this.</em> <span class="anchor" id="line-343"></span><span class="anchor" id="line-344"></span></li></ul><p class="line874">Now we should be able to perform the replication in the other direction: <span class="anchor" id="line-345"></span><span class="anchor" id="line-346"></span><p class="line867"><span class="anchor" id="line-347"></span><span class="anchor" id="line-348"></span><span class="anchor" id="line-349"></span><span class="anchor" id="line-350"></span><pre><span class="anchor" id="line-1-22"></span>client.foo.example.com% vrepl -v -s vesta.bar.example.com -e+ /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-18"></span>exists  /vesta/foo.example.com/a/1
<span class="anchor" id="line-3-9"></span>attribs /vesta/foo.example.com/a/1</pre><span class="anchor" id="line-351"></span><span class="anchor" id="line-352"></span><p class="line874">Just to convince ourselves that this is working, let's make an attribute change locally and make sure that it gets propagated: <span class="anchor" id="line-353"></span><span class="anchor" id="line-354"></span><p class="line867"><span class="anchor" id="line-355"></span><span class="anchor" id="line-356"></span><pre><span class="anchor" id="line-1-23"></span>client.bar.example.com% vattrib -a &quot;test-attribute&quot; &quot;jsmith@bar was here&quot; /vesta/foo.example.com/a/1</pre><span class="anchor" id="line-357"></span><p class="line867"><span class="anchor" id="line-358"></span><span class="anchor" id="line-359"></span><span class="anchor" id="line-360"></span><span class="anchor" id="line-361"></span><span class="anchor" id="line-362"></span><span class="anchor" id="line-363"></span><pre><span class="anchor" id="line-1-24"></span>client.foo.example.com% vrepl -v -s vesta.bar.example.com -e+ /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-19"></span>exists  /vesta/foo.example.com/a/1
<span class="anchor" id="line-3-10"></span>attribs /vesta/foo.example.com/a/1
<span class="anchor" id="line-4-7"></span>client.foo.example.com% vattrib -g &quot;test-attribute&quot; /vesta/foo.example.com/a/1
<span class="anchor" id="line-5-6"></span>jsmith@bar was here</pre><span class="anchor" id="line-364"></span><span class="anchor" id="line-365"></span><p class="line867">
<h3 id="Access_from_Destination_as_Requestor">Access from Destination as Requestor</h3>
<span class="anchor" id="line-366"></span><span class="anchor" id="line-367"></span><p class="line874">When performing a replication, the destination makes requests to the source repository to read the objects being replicated.  These requests are made with the identity of the user requesting the replication. <span class="anchor" id="line-368"></span><span class="anchor" id="line-369"></span><p class="line862">When the local repository is the destination and the source is a remote rpeository, this seems perfectly natural.  For example, above the user ran the replicator on <tt>client.bar.example.com</tt> to copy an object from the remote repository <tt>vesta.foo.example.com</tt> to the local repository.  The requests from the destination repository host used the global identity of the user running the replicator (<tt>jsmith@bar.example.com</tt>).  This matches the line we added to the <a class="http" href="../vesta/doc/man/html/repository.8.html#Export%20file">repository export file</a> earlier. <span class="anchor" id="line-370"></span><span class="anchor" id="line-371"></span><ul><li style="list-style-type:none"><p class="line891"><em>This can be thought of as a &quot;pull&quot; replication.</em> <span class="anchor" id="line-372"></span><span class="anchor" id="line-373"></span></li></ul><p class="line862">If the local repository is the replication source and the destination is a remote repository, things are a little different.  If the user ran the replicator on <tt>client.bar.example.com</tt> to copy an object from the local repository to the remote repository, requests would arrive from <tt>vesta.foo.example.com</tt> with the global identity of the user running the rpelicator (<tt>jsmith@bar.example.com</tt>).  This would <strong>not</strong> match the <a class="http" href="../vesta/doc/man/html/repository.8.html#Export%20file">export file</a> entries we added earlier.   <span class="anchor" id="line-374"></span><span class="anchor" id="line-375"></span><ul><li style="list-style-type:none"><p class="line891"><em>This can be thought of as a &quot;push&quot; replication.</em> <span class="anchor" id="line-376"></span><span class="anchor" id="line-377"></span></li></ul><p class="line862">To support replication in from the local repository to a remote repository, we'll need to add some entries to the export files of our two repositories.  In the export file on &quot;<tt>vesta.foo.example.com</tt>&quot; let's add these lines: <span class="anchor" id="line-378"></span><span class="anchor" id="line-379"></span><p class="line867"><span class="anchor" id="line-380"></span><span class="anchor" id="line-381"></span><span class="anchor" id="line-382"></span><pre><span class="anchor" id="line-1-25"></span># Allow peer repository in with our realm to support &quot;push&quot; replication
<span class="anchor" id="line-2-20"></span>vesta.bar.example.com: allow global foo.example.com</pre><span class="anchor" id="line-383"></span><span class="anchor" id="line-384"></span><p class="line862">Similarly, in the export file on &quot;<tt>vesta.bar.example.com</tt>&quot; we'll add these lines: <span class="anchor" id="line-385"></span><span class="anchor" id="line-386"></span><p class="line867"><span class="anchor" id="line-387"></span><span class="anchor" id="line-388"></span><span class="anchor" id="line-389"></span><pre><span class="anchor" id="line-1-26"></span># Allow peer repository in with our realm to support &quot;push&quot; replication
<span class="anchor" id="line-2-21"></span>vesta.foo.example.com: allow global bar.example.com</pre><span class="anchor" id="line-390"></span><span class="anchor" id="line-391"></span><ul><li style="list-style-type:none"><p class="line891"><em>Remember that after modifying the export file, you need to get the repository server to reload it either with the <a class="http" href="../vesta/doc/man/html/vaccessrefresh.8.html">vaccessrefresh</a> utility or by stopping and restarting the repository server process.</em> <span class="anchor" id="line-392"></span><span class="anchor" id="line-393"></span></li></ul><p class="line874">Now let's test this: <span class="anchor" id="line-394"></span><span class="anchor" id="line-395"></span><p class="line867"><span class="anchor" id="line-396"></span><span class="anchor" id="line-397"></span><span class="anchor" id="line-398"></span><span class="anchor" id="line-399"></span><pre><span class="anchor" id="line-1-27"></span>client.foo.example.com% vrepl -v -d vesta.bar.example.com -e+ /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-22"></span>exists  /vesta/foo.example.com/a/1
<span class="anchor" id="line-3-11"></span>attribs /vesta/foo.example.com/a/1</pre><span class="anchor" id="line-400"></span><p class="line867"><span class="anchor" id="line-401"></span><span class="anchor" id="line-402"></span><span class="anchor" id="line-403"></span><span class="anchor" id="line-404"></span><pre><span class="anchor" id="line-1-28"></span>client.bar.example.com% vrepl -v -d vesta.foo.example.com -e+ /vesta/foo.example.com/a/1
<span class="anchor" id="line-2-23"></span>exists  /vesta/foo.example.com/a/1
<span class="anchor" id="line-3-12"></span>attribs /vesta/foo.example.com/a/1</pre><span class="anchor" id="line-405"></span><span class="anchor" id="line-406"></span><p class="line867">
<h1 id="Mastership">Mastership</h1>
<span class="anchor" id="line-407"></span><span class="anchor" id="line-408"></span><p class="line862">Each object under <tt>/vesta</tt> has a <em>master flag</em>.  You can check the master flag with <a class="http" href="../vesta/doc/man/html/vattrib.1.html">vattrib</a> which prints &quot;<tt>master</tt>&quot; or &quot;<tt>nonmaster</tt>&quot;. <span class="anchor" id="line-409"></span><span class="anchor" id="line-410"></span><p class="line862">Only a single repository can have the master flag set for an object at once.  That is the <em>master repository</em> for that object.  The replica of an object at its master repository is called the <em>master copy</em> of the object.  Changes to an object can only be made at the <em>master repository</em>.  For example, if you want to check out a package, its master repository must grant you permission to do so. <span class="anchor" id="line-411"></span><span class="anchor" id="line-412"></span><p class="line867">
<h2 id="Finding_the_Master">Finding the Master</h2>
<span class="anchor" id="line-413"></span><span class="anchor" id="line-414"></span><p class="line874">The repository tools locate the master copy of an object using several methods: <span class="anchor" id="line-415"></span><span class="anchor" id="line-416"></span><ul><li><p class="line862">Through <tt>master-repository</tt> attributes.  These contain a pointer to the peer repository which is believed to have mastership of the object.  (These are only considered <em>hints</em> and are not necessarily authoritative.) <span class="anchor" id="line-417"></span></li><li><p class="line862">Additional repositories to be checked can be specified in the <a class="http" href="../vesta/doc/man/html/vesta.cfg.5.html">configuration file</a> with the setting <tt>[UserInterface]DefaultHints</tt>. <span class="anchor" id="line-418"></span></li><li><p class="line862">Some tools allow the user to <a class="http" href="../vesta/doc/man/html/vcheckout.1.html#-h">specify additional repositories to check on the command line</a>. <span class="anchor" id="line-419"></span><span class="anchor" id="line-420"></span></li></ul><p class="line867">
<h2 id="Transferring_Mastership">Transferring Mastership</h2>
<span class="anchor" id="line-421"></span><span class="anchor" id="line-422"></span><p class="line867"><em>Mastership transfer</em> is the process by which the master flag can be moved from one repository to another.  <a class="http" href="../vesta/doc/man/html/vmaster.1.html">vmaster</a> can be used to explicitly transfer mastership, but it's much more common for tools like <a class="http" href="../vesta/doc/man/html/vcheckout.1.html">vcheckout</a> to automatically transfer mastership for the user. <span class="anchor" id="line-423"></span><span class="anchor" id="line-424"></span><p class="line867">
<h3 id="Access_Controls">Access Controls</h3>
<span class="anchor" id="line-425"></span><span class="anchor" id="line-426"></span><p class="line862">The <tt>#mastership-to</tt> attribute lists the addresses of repositories we're willing transfer masterhip to. <span class="anchor" id="line-427"></span><span class="anchor" id="line-428"></span><p class="line862">The <tt>#mastership-from</tt> attribute lists the addresses of repositories we're willing to accept a mastership transfer from. <span class="anchor" id="line-429"></span><span class="anchor" id="line-430"></span><p class="line867">
<h3 id="Networking_Details">Networking Details</h3>
<span class="anchor" id="line-431"></span><span class="anchor" id="line-432"></span><ul><li style="list-style-type:none"><p class="line891"><em>You can probably skip this description of the details of how mastership transfer works.</em> <span class="anchor" id="line-433"></span><span class="anchor" id="line-434"></span></li></ul><p class="line874">Mastership transfer is a handshake protocol.  It proceeds in several steps: <span class="anchor" id="line-435"></span><span class="anchor" id="line-436"></span><ol type="1"><li>The client locates the master repository. <span class="anchor" id="line-437"></span><ul><li><p class="line862">Let's suppose that the master is <tt>vesta.foo.example.com</tt>. <span class="anchor" id="line-438"></span></li></ul></li><li><p class="line862">The client contacts the repository it wants to become the master and asks it to <em>acquire mastership</em> from the current master. <span class="anchor" id="line-439"></span><ul><li><p class="line862">Let's suppose the client wants <tt>vesta.bar.example.com</tt> to become the master.  It tells <tt>vesta.bar.example.com</tt> &quot;acquire mastership from <tt>vesta.foo.example.com:21776</tt>&quot; <span class="anchor" id="line-440"></span></li></ul></li><li><p class="line862">After deciding whether it will accept this transfer, the repository acquiring mastership contacts the current master and asks it to <em>cede mastership</em> to it. <span class="anchor" id="line-441"></span><ul><li><p class="line862">In our example, the repository at <tt>vesta.bar.example.com</tt> contacts the repository at <tt>vesta.foo.example.com</tt> and asks &quot;please cede mastership to <tt>vesta.bar.example.com:21776</tt>&quot;. <span class="anchor" id="line-442"></span></li><li>Note that the request to cede mastership goes from the destination to the current master with the identity of the user requesting the transfer.  (This is similar to the way replication works.)  Normally this is a user local to that repository, so the export file at the current master probably already allows this. <span class="anchor" id="line-443"></span></li></ul></li><li>After deciding whether it will accept this transfer, the repository ceding mastership turns off the master flag and contacts the new master and and tells it that it has given up mastership. <span class="anchor" id="line-444"></span><ul><li><p class="line862">In our example, the repository at <tt>vesta.foo.example.com</tt> contacts the repository <tt>vesta.bar.example.com</tt> and says &quot;I've given up mastership, you can have it now&quot; <span class="anchor" id="line-445"></span></li><li><p class="line862">Note that this also uses the identity of the requesting user.  This user probably isn't local to the repository making the request, so you'll need to allow their realm in from the peer repository.  In our example, this means that the export file on <tt>vesta.bar.example.com</tt> must allow <tt>vesta.foo.example.com</tt> with realm <tt>bar.example.com</tt>.  (This is similar to what we need for &quot;push&quot; replication.) <span class="anchor" id="line-446"></span></li></ul></li><li>Finally, the repository acquiring mastership turns on its master flag and indicates to the client that it has acquired mastership. <span class="anchor" id="line-447"></span><span class="anchor" id="line-448"></span></li></ol><p class="line867"><img alt="mastership-transfer.png" class="attachment" src="RemoteCheckoutSetup%3Faction=AttachFile&amp;do=get&amp;target=mastership-transfer.png" title="mastership-transfer.png" /> <span class="anchor" id="line-449"></span><span class="anchor" id="line-450"></span><p class="line867">
<h3 id="Automatic_Recovery">Automatic Recovery</h3>
<span class="anchor" id="line-451"></span><span class="anchor" id="line-452"></span><p class="line874">Mastership transfer is designed to maintain the special property that at most one repository has the master flag set even if something bad happens during the transfer such as a loss of network connectivity or one or both repository servers going down (e.g. from a power loss).  The repository server will automatically retry partially completed mastership transfers. <span class="anchor" id="line-453"></span><span class="anchor" id="line-454"></span><p class="line874">Normally this is completely transparent and users never have to be aware of it.  However, it's worth mentioning because if a repository permanently goes off line peer repositories may continue trying to contact it. <span class="anchor" id="line-455"></span><span class="anchor" id="line-456"></span><p class="line867">
<h1 id="Remote_Checkout_in_Action">Remote Checkout in Action</h1>
<span class="anchor" id="line-457"></span><span class="anchor" id="line-458"></span><p class="line862">Now that we've got all the necessary permissions in place, let's perform an actual remote checkout.  Our user <tt>jsmith</tt> simply uses <a class="http" href="../vesta/doc/man/html/vcheckout.1.html">vcheckout</a> the same way they would for a package that originated in the local repository: <span class="anchor" id="line-459"></span><span class="anchor" id="line-460"></span><p class="line867"><span class="anchor" id="line-461"></span><span class="anchor" id="line-462"></span><span class="anchor" id="line-463"></span><span class="anchor" id="line-464"></span><span class="anchor" id="line-465"></span><pre><span class="anchor" id="line-1-29"></span>client.bar.example.com% vcheckout /vesta/foo.example.com/a
<span class="anchor" id="line-2-24"></span>Reserving version /vesta/foo.example.com/a/2 at vesta.foo.example.com:21776
<span class="anchor" id="line-3-13"></span>Creating session /vesta/foo.example.com/a/checkout/2 at vesta.foo.example.com:21776
<span class="anchor" id="line-4-8"></span>Making working directory /vesta-work/jsmith/a</pre><span class="anchor" id="line-466"></span><span class="anchor" id="line-467"></span><p class="line862">The only difference visible to the user is the &quot;<tt>at&nbsp;vesta.foo.example.com:21776</tt>&quot;.  That tells the user that a remote repository was contacted for those parts of the operation.  After creating the version reservation and the session directory at the remote master, <tt>vcheckout</tt> automatically replicates them to and transfers mastership of them to the local repository.  We can see that the local repository now has mastership of the reservation with <a class="http" href="../vesta/doc/man/html/vattrib.1.html">vattrib</a>: <span class="anchor" id="line-468"></span><span class="anchor" id="line-469"></span><p class="line867"><span class="anchor" id="line-470"></span><span class="anchor" id="line-471"></span><span class="anchor" id="line-472"></span><span class="anchor" id="line-473"></span><span class="anchor" id="line-474"></span><span class="anchor" id="line-475"></span><span class="anchor" id="line-476"></span><span class="anchor" id="line-477"></span><span class="anchor" id="line-478"></span><span class="anchor" id="line-479"></span><span class="anchor" id="line-480"></span><span class="anchor" id="line-481"></span><span class="anchor" id="line-482"></span><span class="anchor" id="line-483"></span><span class="anchor" id="line-484"></span><span class="anchor" id="line-485"></span><span class="anchor" id="line-486"></span><span class="anchor" id="line-487"></span><span class="anchor" id="line-488"></span><span class="anchor" id="line-489"></span><span class="anchor" id="line-490"></span><pre><span class="anchor" id="line-1-30"></span>client.bar.example.com% vattrib /vesta/foo.example.com/a/2
<span class="anchor" id="line-2-25"></span>master stub
<span class="anchor" id="line-3-14"></span>work-dir
<span class="anchor" id="line-4-9"></span>        /vesta-work/jsmith/a
<span class="anchor" id="line-5-7"></span>session-dir
<span class="anchor" id="line-6-6"></span>        /vesta/foo.example.com/a/checkout/2
<span class="anchor" id="line-7-4"></span>old-version
<span class="anchor" id="line-8-4"></span>        /vesta/foo.example.com/a/1
<span class="anchor" id="line-9-3"></span>master-repository
<span class="anchor" id="line-10-3"></span>        vesta.bar.example.com:21776
<span class="anchor" id="line-11-1"></span>checkout-time
<span class="anchor" id="line-12-1"></span>        Fri Dec  2 13:27:46 EDT 2005
<span class="anchor" id="line-13"></span>checkout-by
<span class="anchor" id="line-14"></span>        jsmith@bar.example.com
<span class="anchor" id="line-15"></span>#mode
<span class="anchor" id="line-16"></span>        775
<span class="anchor" id="line-17"></span>checkout-to
<span class="anchor" id="line-18"></span>        vesta.bar.example.com:21776
<span class="anchor" id="line-19"></span>checkout-from
<span class="anchor" id="line-20"></span>        vesta.foo.example.com:21776</pre><span class="anchor" id="line-491"></span><span class="anchor" id="line-492"></span><p class="line874">Also worth noting are the last two attributes: <span class="anchor" id="line-493"></span><span class="anchor" id="line-494"></span><ul><li><p class="line891"><tt>checkout-to</tt> records the address of the local repository where the change is being made <span class="anchor" id="line-495"></span></li><li><p class="line891"><tt>checkout-from</tt> records the address of the remote repository which has mastership of the package <span class="anchor" id="line-496"></span><span class="anchor" id="line-497"></span></li></ul><p class="line862">These attributes are also used by other tools.  For example, a user at <tt>foo.example.com</tt> running <a class="http" href="../vesta/doc/man/html/vwhohas.1.html">vwhohas</a> will see that a user at <tt>bar.example.com</tt> has the package checked out: <span class="anchor" id="line-498"></span><span class="anchor" id="line-499"></span><p class="line867"><span class="anchor" id="line-500"></span><span class="anchor" id="line-501"></span><span class="anchor" id="line-502"></span><pre><span class="anchor" id="line-1-31"></span>client.foo.example.com% vwhohas /vesta/foo.example.com
<span class="anchor" id="line-2-26"></span>/vesta/foo.example.com/a/2  jsmith@bar.example.com  vesta.bar.example.com:21776</pre><span class="anchor" id="line-503"></span><span class="anchor" id="line-504"></span><p class="line862">All the user's activities before checking in happen locally.  Editing and taking snapshots with <a class="http" href="../vesta/doc/man/html/vadvance.1.html">vadvance</a> only use the local repository.  Even filling in the reserved version on checkin happens locally.  After doing the local part, <a class="http" href="../vesta/doc/man/html/vcheckin.1.html">vcheckin</a> will replicate the version back to the repository in the <tt>checkout-from</tt> attribute: <span class="anchor" id="line-505"></span><span class="anchor" id="line-506"></span><p class="line867"><span class="anchor" id="line-507"></span><span class="anchor" id="line-508"></span><span class="anchor" id="line-509"></span><span class="anchor" id="line-510"></span><span class="anchor" id="line-511"></span><pre><span class="anchor" id="line-1-32"></span>client.bar.example.com% vcheckin /vesta-work/jsmith/a
<span class="anchor" id="line-2-27"></span>Checking in /vesta/foo.example.com/a/2
<span class="anchor" id="line-3-15"></span>Deleting /vesta-work/jsmith/a
<span class="anchor" id="line-4-10"></span>Replicating /vesta/foo.example.com/a/2 to vesta.foo.example.com:21776</pre><span class="anchor" id="line-512"></span><span class="anchor" id="line-513"></span><ul><li style="list-style-type:none"><p class="line891"><em>This replication isn't strictly necessary, and if it fails the checkin will still be complete locally.  The replication could be re-done later with <a class="http" href="../vesta/doc/man/html/vrepl.1.html">vrepl</a>.  However, <tt>/vesta/foo.example.com/a/2</tt> would still be a <a class="http" href="../vesta/doc/man/html/vesta-intro.1.html#reservation_stub">reservation stub</a> rather than the checked-in version over at <tt>vesta.foo.example.com</tt>.</em> <span class="anchor" id="line-514"></span><span class="anchor" id="line-515"></span></li></ul><p class="line867">
<h1 id="Summary_.2F_Quick_Reference">Summary / Quick Reference</h1>
<span class="anchor" id="line-516"></span><span class="anchor" id="line-517"></span><p class="line867"><span class="anchor" id="quick_ref"></span> <span class="anchor" id="line-518"></span><span class="anchor" id="line-519"></span><p class="line874">Skipping over all the detailed exaplantion and examples, here's everything you need to have set up for remote checkout to work: <span class="anchor" id="line-520"></span><span class="anchor" id="line-521"></span><ul><li>You must have a functional TCP/IP infrastructure with connectivity between the peer sites. <span class="anchor" id="line-522"></span></li><li>Each repository must have a hostname which resolves to an address which can be used to contact that repository at any site. <span class="anchor" id="line-523"></span><ul><li>In other words, the hostname of your repository must be usable for contacting it from a remote repository and vice versa. <span class="anchor" id="line-524"></span></li></ul></li><li><p class="line862">Users must be granted read/write access to all participating repositories through the <a class="http" href="../vesta/doc/man/html/repository.8.html#Export%20file">export file</a> <span class="anchor" id="line-525"></span><ul><li><p class="line862">In other words, use &quot;<tt>allow&nbsp;global</tt>&quot; not &quot;<tt>readonly&nbsp;global</tt>&quot; <span class="anchor" id="line-526"></span></li><li>Read-only access is sufficient for a replication source, but not mastership transfer <span class="anchor" id="line-527"></span></li></ul></li><li>Each peer repository must also be allowed in with the local realm to allow transactions initiated by local users which pass through remote repositories <span class="anchor" id="line-528"></span><ul><li>This is needed for both mastership transfer and &quot;push&quot; replication <span class="anchor" id="line-529"></span><ul><li><p class="line891"><a class="http" href="../vesta/doc/man/html/vcheckin.1.html">vcheckin</a> performs a &quot;push&quot; replication to copy the new version back to the remote master <span class="anchor" id="line-530"></span></li></ul></li><li>This is not needed for strictly &quot;pull&quot; replication <span class="anchor" id="line-531"></span></li></ul></li><li><p class="line862">All peer repositories must have their addresses listed in a <tt>#replicate-from</tt> attribute which applies to the hierarchy in which you'll be performing remote checkouts <span class="anchor" id="line-532"></span><ul><li><p class="line862">A remote checkout replicates <strong>from</strong> the master repository <span class="anchor" id="line-533"></span></li><li><p class="line862">A remote checkin replicates <strong>to</strong> the master repository <span class="anchor" id="line-534"></span></li></ul></li><li><p class="line862">The master repositories of packages must have their addresses listed in a <tt>#mastership-from</tt> attribute which applies to the hierarchy in which you'll be performing remote checkouts <span class="anchor" id="line-535"></span><ul><li>The repository local to the checkout must be willing to accept a transfer of mastership for the new version reservation stub and the session directory <span class="anchor" id="line-536"></span></li><li><p class="line862">It's advisable to treat this like <tt>#replicate-from</tt> and allow transfers in either direction between all peers <span class="anchor" id="line-537"></span></li></ul></li><li><p class="line862">The non-master repositories which will be local to checkouts must have their addresses listed in a <tt>#mastership-to</tt> attribute which applies to the hierarchy in which you'll be performing remote checkouts <span class="anchor" id="line-538"></span><ul><li>The master repository of the package must be willing to grant a transfer of mastership for the new version reservation stub and the session directory to the repository local to the checkout <span class="anchor" id="line-539"></span></li><li><p class="line862">It's advisable to treat this like <tt>#replicate-from</tt> and allow transfers in either direction between all peers <span class="anchor" id="line-540"></span></li></ul></ul><span class="anchor" id="bottom"></span></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>
</html>

