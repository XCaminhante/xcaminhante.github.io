<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2K.1beta (1.47)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>FuncDef</TITLE>
<META NAME="description" CONTENT="FuncDef">
<META NAME="keywords" CONTENT="paper">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2K.1beta">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="paper.css">

<LINK REL="next" HREF="node145.html">
<LINK REL="previous" HREF="node143.html">
<LINK REL="up" HREF="node133.html">
<LINK REL="next" HREF="node145.html">
</HEAD>

<body bgcolor="#efefff">
<!--Navigation Panel-->
<A NAME="tex2html2335"
  HREF="node145.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="icons/next.png"></A> 
<A NAME="tex2html2331"
  HREF="node133.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="icons/up.png"></A> 
<A NAME="tex2html2325"
  HREF="node143.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="icons/prev.png"></A> 
<A NAME="tex2html2333"
  HREF="node6.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2336"
  HREF="node145.html">FuncCall</A>
<B> Up:</B> <A NAME="tex2html2332"
  HREF="node133.html">Evaluation Rules</A>
<B> Previous:</B> <A NAME="tex2html2326"
  HREF="node143.html">Iterate</A>
 &nbsp <B>  <A NAME="tex2html2334"
  HREF="node6.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION0013331100000000000000"></A><A NAME="sect:SDL-funcdef"></A>
<BR>
FuncDef
</H3>

<P>
<
<P>
The function definition syntax allows a suffix of the formal
parameters to have associated default values.

<P>
<PRE>
FuncDef    ::= Id Formals+ [ TypeQual ] Block
Formals    ::= ( FormalArgs )
FormalArgs ::= TypedId*,
             | { TypedId = Expr }*,
             | TypedId { , TypedId }* { , TypedId = Expr }+
</PRE>

<P>
The three alternatives for FormalArgs correspond to the cases in which
no arguments are defaulted, all arguments are defaulted, and some
arguments are defaulted, respectively.

<P>
Note that the syntax allows multiple <TT>Formals</TT> to
follow the function name. As the rules below describe, the use of
multiple Formals produces a sequence of curried functions, all but the
first of which is anonymous.

<P>
<
<P>
<PRE>
Eval( Id Formals_1 ... Formals_n Block , C) =
  _bind1(id, Eval( e , C1)),
</PRE>

<P>
where:

<UL>
<LI>e = LAMBDA Formals_1 ... LAMBDA Formals_n Block

<P>
</LI>
<LI>C1 = operator+(C, _bind1(id, Eval( e , C1)))
</LI>
</UL>

<P>
Notice the recursive definition of C1. This allows functions to
be self-recursive, but not mutually recursive. Although this recursive
definition looks a little odd, it can be implemented by the evaluator
by introducing a cycle into the context C1. This is the only case
where any Vesta value can contain a cycle (the language syntax and
operators do not allow cyclic lists or bindings to be constructed),
and the cycle is invisible to clients. There is no practical
difficulty in constructing the cycle because, as we are about to see,
the ``evaluation'' of a <TT>LAMBDA</TT> is purely syntactic.

<P>
Also note that this rule produces a LAMBDA construct in the
``extended'' language that is not generated by any non-terminal of the
grammar. The evaluation of LAMBDA produces a t_closure value <!-- MATH
 $\langle
e, f, b\rangle$
 -->
<IMG
 WIDTH="55" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img96.png"
 ALT="$\langle e, f, b\rangle$"> as described in Section&nbsp;<A HREF="node131.html#sect:SDL-value-space">A.3.1</A>.

<P>
The following is the simple case of LAMBDA, where all actual
parameters must be given in any application of the closure. The reason
for the restriction on the use of ``.'' as a formal parameter is
treated below in the section on function calls.

<P>
<PRE>
Eval( LAMBDA (Id_1, ..., Id_m)
      LAMBDA Formals_2 ... LAMBDA Formals_n Block , C) =
  &lt;LAMBDA Formals_2 ... LAMBDA Formals_n Block, f, C&gt;,
</PRE>

<P>
where <EM>f</EM> is a list of pairs
<!-- MATH
 $(\mbox{\em id}_i, \langle\mbox{emptyExpr}\rangle)$
 -->
<IMG
 WIDTH="126" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img115.png"
 ALT="$(\mbox{\em id}_i, \langle\mbox{emptyExpr}\rangle)$"> such that
<!-- MATH
 $\mbox{\em id}_i$
 -->
<IMG
 WIDTH="24" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img116.png"
 ALT="$\mbox{\em id}_i$"> is the t_text representation of Id_i, for <IMG
 WIDTH="12" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img117.png"
 ALT="$i$"> in
the closed interval <IMG
 WIDTH="44" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img118.png"
 ALT="$[1, m]$">. If any of the identifiers Id_i is ``.'',
the evaluation halts with a runtime error.

<P>
In the typical case where only one set of Formals is specified
(that is, <IMG
 WIDTH="45" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img119.png"
 ALT="$n = 1$">), the first element of the resulting closure
value is simply a Block.

<P>
Next is the general case of LAMBDA, in which ``default
expressions'' are given for a suffix of the formal parameter list.
Functions may be called with fewer actuals than formals if each formal
corresponding to an omitted actual includes an expression specifying
the default value to be computed. When the closure is applied, if an
actual parameter is missing, its formal's expression is evaluated
(in the context of the LAMBDA) and passed instead. The following
section on FuncCall defines this precisely.

<P>
<PRE>
Eval( 
    LAMBDA (Id_1,... Id_k, Id_k+1=Expr_k+1,... Id_m=Expr_m)
    LAMBDA Formals_2 ... LAMBDA Formals_n Block , C) =
  &lt;LAMBDA Formals_2 ... LAMBDA Formals_n Block, f, C&gt;,
</PRE>

<P>
where <EM>f</EM> is a list of pairs <!-- MATH
 $(\mbox{\em id}_i, \mbox{\em expr}_i)$
 -->
<IMG
 WIDTH="77" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img120.png"
 ALT="$(\mbox{\em id}_i, \mbox{\em expr}_i)$"> such that:

<UL>
<LI><!-- MATH
 $\mbox{\em id}_i$
 -->
<IMG
 WIDTH="24" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img116.png"
 ALT="$\mbox{\em id}_i$"> is the t_text representation of Id_i,
for <IMG
 WIDTH="12" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img117.png"
 ALT="$i$"> in <IMG
 WIDTH="44" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img118.png"
 ALT="$[1, m]$">,

<P>
</LI>
<LI><!-- MATH
 $\mbox{\em expr}_i$
 -->
<IMG
 WIDTH="39" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img121.png"
 ALT="$\mbox{\em expr}_i$"> is <!-- MATH
 $\langle\mbox{emptyExpr}\rangle$
 -->
<IMG
 WIDTH="89" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img104.png"
 ALT="$\langle\mbox{emptyExpr}\rangle$">,
for <IMG
 WIDTH="12" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img117.png"
 ALT="$i$"> in <IMG
 WIDTH="39" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img122.png"
 ALT="$[1, k]$">, and

<P>
</LI>
<LI><!-- MATH
 $\mbox{\em expr}_i$
 -->
<IMG
 WIDTH="39" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img121.png"
 ALT="$\mbox{\em expr}_i$"> is Expr_i, for <IMG
 WIDTH="12" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img117.png"
 ALT="$i$"> in <IMG
 WIDTH="72" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img123.png"
 ALT="$[k+1, m]$">.
</LI>
</UL>

<P>
As before, if any of the identifiers Id_i is ``.'', 
the evaluation halts with a runtime error.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2335"
  HREF="node145.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="icons/next.png"></A> 
<A NAME="tex2html2331"
  HREF="node133.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="icons/up.png"></A> 
<A NAME="tex2html2325"
  HREF="node143.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="icons/prev.png"></A> 
<A NAME="tex2html2333"
  HREF="node6.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html2336"
  HREF="node145.html">FuncCall</A>
<B> Up:</B> <A NAME="tex2html2332"
  HREF="node133.html">Evaluation Rules</A>
<B> Previous:</B> <A NAME="tex2html2326"
  HREF="node143.html">Iterate</A>
 &nbsp <B>  <A NAME="tex2html2334"
  HREF="node6.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Allan Heydon, Roy Levin, Timothy Mann, Yuan Yu
</ADDRESS>
</BODY>
</HTML>
